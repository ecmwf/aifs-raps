module load LUMI/24.03 partition/G
module load gnuplot/5.4.10-cpeCray-24.03


# 2. setup_env

export ENV_TYPE='hybrid_container'
export INPUT_HYBRID_CONTAINER_PATH='/scratch/project_465000527/obrienca/aifs/containers/lumi-pytorch-rocm-6.1.3-python-3.12-pytorch-v2.4.1.sif'
export INPUT_HYBRID_VENV_PATH="$PROJECT/aifs/envs/raps"
export INPUT_HYBRID_CONTAINER_EXTRA_BINDS="/var/spool/slurmd,/opt/cray/,/usr/lib64/libcxi.so.1,/usr/lib64/libjansson.so.4,$SCRATCH,$PROJECT"
export INPUT_HYBRID_CONTAINER_INIT_CMD='source /opt/miniconda3/bin/activate pytorch' # an optional command which is run each time you enter the container

# 3. running
export AIFS_DATA_PATH=/scratch/project_465000527/obrienca/aifs/inputs
export AIFS_GRIDS_PATH=/scratch/project_465000527/obrienca/aifs/inputs/grids
export AIFS_OUTPUT_PATH=$SCRATCH/aifs/outputs/raps
export AIFS_NUM_GPUS_PER_NODE=8
export AIFS_SYSTEM_SPECIFIC_HYDRA_ARGS="diagnostics.benchmark_profiler.memory.enabled=False"
